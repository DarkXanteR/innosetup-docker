#!/bin/sh

set -eu

winpaths() {
    for arg in "$@"; do
        if [ -e "$arg" ]; then
            winepath -w "$arg"
        else
            echo "$arg"
        fi
    done
}

winenv() {
    wine cmd /c "echo $1" | tr -d '\r'
}

PROGFILES_PATH="$(winepath -u "$(winenv %PROGRAMFILES%)")"

INNO_BIN="Inno Setup 5/ISCC.exe"
INNO_PATH="${PROGFILES_PATH}/${INNO_BIN}"

eval set -- "$(winpaths "$@")"

exec wine "$INNO_PATH" $(winpaths "$@")
